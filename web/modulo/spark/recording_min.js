RecordingManager=function(){function h(){e=0;0<k.length&&(k.length=0);0<f.length&&(f.length=0)}function p(a){if(0<e&&0<f.length){var c="Please download the recorded file first";r.exit();return(a||window.event).returnValue=c}}function l(a){for(var c=new Uint8Array(64),d=c,f=a.filetag||t,g=0,h=0;4>h;h++)d[g++]=f.charCodeAt(h);b(c,u,2,4);b(c,a.width,2,6);b(c,a.height,2,8);b(c,a.color,1,10);b(c,e,8,11);b(c,a.duration,8,19);b(c,v,4,27);k.push(c)}function b(a,c,d,b){for(--d;0<=d;d--)a[b++]=c>>8*d&255}function m(a){var c=
a.getType(),d=new Uint8Array(-1==c?8:10);b(d,a.getLen()+(-1==c?0:2),4,0);b(d,a.getTime()-e,4,4);-1!=c&&(b(d,a.getType()&255,1,8),b(d,a.getType()>>8,1,9));k.push(d);k.push(a.getData())}var f=[],w=".rdpv",n="",t="RDPV",e=0,u=0,x="name",g,q="",v=1,k=[],r=this;this.setHeader=function(a){h();e=(new Date).getTime();g=a;n=w;null!=g.namesuffix&&void 0!=g.namesuffix&&(n=g.namesuffix);q=g[x]+e+n;window.addEventListener("beforeunload",p,!1)};this.add=function(a){0<e&&f.push(a)};this.exit=function(){var a=f.length;
if(0!=a&&0!=e){g.duration=f[a-1].getTime()-e;l(g);for(var c=0;c<a;c++)m(f[c]);a=new Blob(k,{type:"application/octet-binary"});h();var b=URL.createObjectURL(a),a="";__svi18n&&__svi18n.info&&(a=__svi18n.info.recready);a||(a="Recorded file is ready. Please right click and save the link.");a='<a href="'+b+'" target="_blank" download="'+q+'">'+a+"</a>";hi5.notifications.notify({msg:a,cbClose:function(){setTimeout(function(){(window.URL||window.webkitURL).revokeObjectURL(b)},999)}})}}};
RecordingObj=function(h,p,l,b){var m=(new Date).getTime();"undefined"==typeof b&&(b=48);this.strToInt=function(b){return parseInt(b,16)};this.getLen=function(){return l};this.getTime=function(){return m};this.getType=function(){return b};this.getData=function(){return h}};
